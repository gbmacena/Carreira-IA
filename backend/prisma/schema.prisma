// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  name      String
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  analyses Analysis[]
  refreshTokens RefreshToken[]

  @@map("users")
}

model RefreshToken {
  id        String   @id @default(uuid())
  token     String   @unique
  userId    String
  expiresAt DateTime
  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("refresh_tokens")
}

model Analysis {
  id          String   @id @default(uuid())
  userId      String
  fileName    String
  filePath    String
  status      AnalysisStatus @default(PENDING)
  jobId       String?
  
  generalSummary String?
  estimatedLevel String? 
  candidateLevel String? 
  atsScore Float? 
  overallOverview String?
  
  strengths    Json?
  weaknesses   Json?
  suggestions  Json?
  
  sectionFeedback Json?
  
  jobDescription String?
  jobMatch       Json? 
  
  scores Json? 
  overallScore Float? 
  
  errorMessage String?
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  completedAt DateTime?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("analyses")
}

enum AnalysisStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

